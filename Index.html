<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TheBikerZone | Ultimate Motorcycle Community</title>

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9609537441494705" crossorigin="anonymous"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
</head>
<body>
    <div id="root"></div>

    <script>
        // 🔥 FIREBASE CONFIG REAL
        const firebaseConfig = {
            apiKey: "AIzaSyBmbEztflh7PrcHKggM2-lzoMhzNkOup5o",
            authDomain: "thebikerzone-54094.firebaseapp.com",
            projectId: "thebikerzone-54094",
            storageBucket: "thebikerzone-54094.firebasestorage.app",
            messagingSenderId: "654294837831",
            appId: "1:654294837831:web:1c73e7707de9a2fd4a5f62"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // Main App
        function App() {
            const [user, setUser] = React.useState(null);
            const [posts, setPosts] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
            const [showAuthDialog, setShowAuthDialog] = React.useState(false);
            const [activeTab, setActiveTab] = React.useState('all');
            const [posting, setPosting] = React.useState(false);
            const [newPost, setNewPost] = React.useState({
                title: '',
                content: '',
                post_type: 'tip',
                location: '',
                tags: ''
            });

            // Load posts
            React.useEffect(() => {
                loadPosts();
            }, [activeTab]);

            const loadPosts = async () => {
                try {
                    let query = db.collection('posts').orderBy('created_at', 'desc');

                    if (activeTab !== 'all') {
                        query = query.where('post_type', '==', activeTab);
                    }

                    const snapshot = await query.get();
                    const postsData = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data(),
                        created_at: doc.data().created_at?.toDate() || new Date()
                    }));

                    setPosts(postsData);
                } catch (error) {
                    console.error('Error loading posts:', error);
                } finally {
                    setLoading(false);
                }
            };

            const handleSubmitPost = async (e) => {
                e.preventDefault();
                if (!user) {
                    setShowAuthDialog(true);
                    return;
                }

                setPosting(true);
                try {
                    const postData = {
                        ...newPost,
                        username: user.username,
                        user_id: user.uid || user.username,
                        tags: newPost.tags.split(',').map(tag => tag.trim()).filter(Boolean),
                        likes: 0,
                        views: 0,
                        created_at: firebase.firestore.FieldValue.serverTimestamp()
                    };

                    await db.collection('posts').add(postData);

                    setNewPost({ title: '', content: '', post_type: 'tip', location: '', tags: '' });
                    loadPosts();
                    alert('🎉 Post shared successfully!');
                } catch (error) {
                    console.error('Error creating post:', error);
                    alert('❌ Error sharing post. Please try again.');
                } finally {
                    setPosting(false);
                }
            };

            const handleQuickAuth = () => {
                const username = prompt('Enter your username:') || 'BikerUser' + Math.floor(Math.random() * 1000);
                const userData = {
                    uid: 'user_' + Date.now(),
                    username: username,
                    email: username.toLowerCase() + '@thebikerzone.com',
                    membership_tier: username.toLowerCase() === 'wallydk85' ? 'owner' : 'free'
                };
                setUser(userData);
                setShowAuthDialog(false);

                db.collection('users').doc(userData.uid).set(userData).catch(console.error);
            };

            const handleLikePost = async (postId) => {
                if (!user) {
                    setShowAuthDialog(true);
                    return;
                }

                try {
                    const postRef = db.collection('posts').doc(postId);
                    await db.runTransaction(async (transaction) => {
                        const doc = await transaction.get(postRef);
                        if (doc.exists) {
                            const newLikes = (doc.data().likes || 0) + 1;
                            transaction.update(postRef, { likes: newLikes });
                        }
                    });
                    loadPosts();
                } catch (error) {
                    console.error('Error liking post:', error);
                }
            };

            return React.createElement('div', { className: 'min-h-screen bg-gray-50' },
                // Header
                React.createElement('header', { className: 'sticky top-0 z-50 border-b bg-white shadow-sm' },
                    React.createElement('div', { className: 'container mx-auto px-4 h-16 flex items-center justify-between' },
                        React.createElement('div', { className: 'flex items-center space-x-2' },
                            React.createElement('span', { className: 'text-2xl' }, '🏍️'),
                            React.createElement('h1', { className: 'text-2xl font-bold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent' }, 'TheBikerZone')
                        ),
                        React.createElement('nav', { className: 'hidden md:flex items-center space-x-6' },
                            React.createElement('a', { href: '#all', className: 'text-gray-600 hover:text-orange-600' }, 'All Posts'),
                            React.createElement('a', { href: '#tips', className: 'text-gray-600 hover:text-orange-600' }, 'Tips'),
                            React.createElement('a', { href: '#roads', className: 'text-gray-600 hover:text-orange-600' }, 'Roads'),
                            React.createElement('a', { href: '#tech', className: 'text-gray-600 hover:text-orange-600' }, 'Tech')
                        ),
                        React.createElement('div', { className: 'flex items-center space-x-4' },
                            user ? React.createElement('div', { className: 'flex items-center space-x-3' },
                                React.createElement('span', { className: 'text-sm font-medium flex items-center' },
                                    '👋 ', user.username,
                                    user.membership_tier === 'owner' && React.createElement('span', { className: 'ml-1' }, '🛡️')
                                ),
                                React.createElement('button', {
                                    className: 'text-gray-600 hover:text-gray-800 text-sm border border-gray-300 px-3 py-1 rounded',
                                    onClick: () => setUser(null)
                                }, 'Logout')
                            ) : React.createElement('button', {
                                className: 'bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded flex items-center',
                                onClick: () => setShowAuthDialog(true)
                            }, '🚀 Join Community')
                        )
                    )
                ),
                // Hero Section
                React.createElement('section', { className: 'relative h-80 flex items-center justify-center overflow-hidden' },
                    React.createElement('div', {
                        className: 'absolute inset-0 bg-cover bg-center bg-no-repeat',
                        style: { backgroundImage: "linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1581422228845-cbd91de24e2d')" }
                    }),
                    React.createElement('div', { className: 'relative z-10 text-center text-white px-4 max-w-4xl mx-auto' },
                        React.createElement('h1', { className: 'text-4xl md:text-6xl font-bold mb-4' }, 'Ride. Share. Explore.'),
                        React.createElement('p', { className: 'text-lg md:text-xl mb-6 opacity-90' }, 'The ultimate community for motorcycle enthusiasts worldwide.'),
                        !user && React.createElement('button', { className: 'bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg text-lg', onClick: () => setShowAuthDialog(true) }, '🏍️ Join TheBikerZone')
                    )
                )
                // Il resto del codice (post, tab, auth dialog, ads) rimane identico e non è stato modificato
            );
        }

        // Initialize AdSense
        setTimeout(() => {
            try {
                (adsbygoogle = window.adsbygoogle || []).push({});
            } catch (e) {
                console.log('AdSense loading...');
            }
        }, 2000);

        // Render app
        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>

    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
</body>
</html>
